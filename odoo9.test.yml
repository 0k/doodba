version: "2"
services:
    sut:
        build:
            context: ./tests/odoo9
            args:
                AGGREGATE: "yes"
                CLEAN: "yes"
                LOCAL_CUSTOM_DIR: .
                # PYTHONOPTIMIZE=2 would fail some tests
                COMPILE: "no"
                PYTHONOPTIMIZE: 0
        links:
            - db
        command: unittest all --stop-after-init

    db:
        image: postgres:9.5-alpine
        environment:
            POSTGRES_USER: odoo
            POSTGRES_PASSWORD: odoopassword
